
//=============================================================================
// Copyright (C) 2008 Alon Zakai ('Kripken') kripkensteiner@gmail.com
//
// This file is part of the Intensity Engine project,
//    http://www.intensityengine.com
//
// The Intensity Engine is free software: you can redistribute it and/or modify
// it under the terms of the GNU Affero General Public License as published by
// the Free Software Foundation, version 3.
//
// The Intensity Engine is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU Affero General Public License for more details.
//
// You should have received a copy of the GNU Affero General Public License
// along with the Intensity Engine.  If not, see
//     http://www.gnu.org/licenses/
//     http://www.gnu.org/licenses/agpl-3.0.html
//=============================================================================

// Use second mouse button to show our edit entities dialog, if hovering
editextend_intensity = [ if (= $has_mouse_target 0) [ editextend ] [ prepare_entity_gui; showgui entity ] ]

edit_entity = [
    if (set_mouse_target_entity $arg1) [
        prepare_entity_gui; showgui entity
    ] [ echo "No such entity" ]
]

edit_client = [
    if (set_mouse_target_client $arg1) [
        prepare_entity_gui; showgui entity
    ] [ echo "No such client" ]
]

// Create entity where we are pointing
editbind F8 place_ent

place_ent = [
    save_mouse_pos
    prepare_entities_gui
]

// New entities

prepare_entities_gui = [
    prepareentityclasses
    showgui entities
]

newgui entities [
    loop i (numentityclasses) [
        entityclass = (getentityclass $i)
        guibutton $entityclass (concat newentnoparams $entityclass)
    ]
]

// Export entities

newexportfilename = "entities.json"

newgui exportentities [
    guilist [
        guitext "filename: "
        guifield newexportfilename 30 []
    ]

    guibar

    guibutton "export" [ run_python (format "export_entities('%1')" $newexportfilename) ]
]

